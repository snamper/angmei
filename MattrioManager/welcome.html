<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<!--[if lt IE 9]>
	<script type="text/javascript" src="lib/html5shiv.js"></script>
	<script type="text/javascript" src="lib/respond.min.js"></script>
	<![endif]-->
	<link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
	<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
	<link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/1.0.8/iconfont.css" />
	<link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
	<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />
	<!--[if IE 6]>
	<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
	<script>DD_belatedPNG.fix('*');</script>
	<![endif]-->
	<title>我的桌面</title>
</head>

<style type="text/css">
	html,body{
		width: 100%;
		height: 100%;
	}
	p{
		margin-bottom: 0;
	}
	.tab1,.tab2,.tab3{
		width: 100%;
	}
	.tab3{
		margin-right: 0;
	}
	table .th{
		font-size: 16px;
	}
	.tab3,.tab2{
		width: 25%;
		float: left;
		margin-right: 3%;
	}
	.tab1{
		width: 44%;
		margin-right: 0;
		float: left;
	}
	.tab p{
		text-align: center;
		font-weight: bold;
		border-bottom: 1px solid #ccc;
        padding-bottom: 5px;
	}
	.tab3wrap,.tab1wrap,.tab2wrap{
		height: 334px;
		max-height: 334px;
		overflow: auto; 
		box-sizing: border-box;
	}
	.mt-20{
		margin-top: 0;
	}
	.tab4,.tab5{
		width: 50%;
		margin-top: 20px;
		float: left; 
	}
	.tab5{
		width: 40%;
		margin-left: 10%;
	}
	.tab4wrap,.tab5wrap{
		height: 334px;
		max-height: 334px;
		overflow: auto;
		box-sizing: border-box;
	}
	button{
		background: #f5fafe;
		border: 0px solid #ccc;
		font-size: 18px;
		cursor: pointer;
		border-radius: 0 10px 10px 0;
		height: 42px;
		box-sizing: border-box;
		width: 316px;
	}
	button:hover{
		border: solid 1px #3bb4f2;
	}
	tbody tr:hover{
		/*background: #f5fafe;*/	
	}
	.loadin{
		position: fixed;
		top: 50%;
		left: 50%;
		transform: translate(-50%,-50%);
		display: none;
	}
	.loadin img{
		width: 200px;
	}
	.text-c span{
		font-size: 18px;
	}
	.wrap {
		width: 250px;
		border:1px solid #ccc;
		border-radius: 10px;
		margin: 0 auto;
		display: inline-block;
	}
	.wrap input{
		border-width: 0px;
		border-radius:10px;
		cursor: pointer;
        text-align: center;
	}
    .span{
        margin-left: 15px;
        color: #fff;
        cursor: pointer;
        border-radius: 3px;
        padding: 2px 8px;
        background: #d23232;
        font-weight: normal;
    }

</style>
<body>
<div class="page-container clearfix">
	<p class="f-20 text-success">欢迎来到MACC后台管理系统 </p>
<div style="margin-bottom: 20px;">
	<div class="text-c"> 
		<span>时间：</span>
		<div class="wrap">
			<input type="text" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'datemax\')||\'%y-%M-%d\'}' })" id="datemin" class="input-text Wdate" style="width:250px; font-size: 18px;height: 42px;">
			<input type="text" onfocus="WdatePicker({ minDate:'#F{$dp.$D(\'datemin\')}',maxDate:'%y-%M-%d' })" id="datemax" class="input-text Wdate" style="width:120px;">
			<!--<button title='点击查看当前日期的接口及用户信息'>点击查看当前日期的接口及用户信息</button>-->
		</div>
	</div>
	<!-- <div class="cl pd-5 bg-1 bk-gray mt-20"> <span class="r">共有数据：<strong class="alltotal">10</strong> 条</span> </div> -->
</div>
	
	
	
	<div class="loadin"><img src="images/timg.gif"/></div>
	<!--<p><span>接口</span><span>客户</span></p>-->
	<div class="tab3 tab welcome">
		<p><span>接口调用次数</span><span class="span" title="点击查看当前时间的接口调用次数" alt="3">查询</span></p>

		<div class="tab1wrap">
			<table class="table table-border table-bordered table-bg mt-20">
				<thead>
					<tr>
						<th>接口</th>
						<th>调用次数</th>
					</tr>
				</thead>
				<tbody >
						
				</tbody>
			</table>
		</div>
	</div>
	<div class="tab2 tab welcome">
		<p><span>产品调用次数</span><span class="span" title="点击查看当前时间的产品调用次数" alt="2">查询</span></p>
		<div class="tab2wrap">
			<table class="table table-border table-bordered table-bg mt-20">
				<thead>
					<tr>
						<th>产品</th>
						<th>调用次数</th>
					</tr>
				</thead>
				<tbody >
						
				</tbody>
			</table>
		</div>
	</div>
	<div class="tab1 tab welcome">
		<p><span>客户调用次数</span><span class="span" title="点击查看当前时间的客户调用次数" alt="1">查询</span></p>
		<div class="tab3wrap">
			<table class="table table-border table-bordered table-bg mt-20">
				<thead>
					<tr>
						<th>用户</th>
						<th>手机号</th>
						<th>次数</th>
					</tr>
				</thead>
				<tbody>
							
				</tbody>
			</table>
		</div>
	</div>
	<div class="tab4 tab welcome">
		<p><span>当前新增用户</span><span class="span" title="点击查看当前时间的当前新增用户" alt="4">查询</span></p>
		<div class="tab4wrap">
			<table class="table table-border table-bordered table-bg mt-20">
				<thead>
					<tr>
						<th>注册方式</th>
						<th>手机号</th>
						<th>时间</th>
					</tr>
				</thead>
				<tbody>
							
				</tbody>
			</table>
		</div>
	</div>
	<div class="tab5 tab welcome">
		<p><span>共多少用户</span><span class="span" title="点击查看当前时间的共多少用户" alt="5">查询</span></p>
		<div class="tab5wrap">
			<table class="table table-border table-bordered table-bg mt-20">
				<thead>
					<tr>
						<th>注册方式</th>
						<th>数量</th>
					</tr>
				</thead>
				<tbody>
							
				</tbody>
			</table>
		</div>
	</div>
</div>



<footer class="footer mt-20">
	<div class="container">
		<p><span>版权所有：昂美数据</span><span>备案号：沪ICP备15027426号-2</span></p>
		<p><span>地址：上海市闵行区沪光东路89号福克斯大厦2号楼103B</span><span>电话：021-5221 2966</span><span>传真：021-5221 2911</span></p>
	</div>
</footer>
<script type="text/javascript" src="lib/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="static/h-ui/js/H-ui.min.js"></script> 
<script type="text/javascript" src="AftermarketBrand/layer/layer.js"></script>
<script type="text/javascript" language="javascript" src="AftermarketBrand/datatables/1.10.0/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="lib/My97DatePicker/4.8/WdatePicker.js?v=20190214"></script>
<script>
    var network = localStorage.getItem("network");
	$("#datemax").hide()
	var year=new Date().getFullYear()
	var Month=(new Date().getMonth()+1).toString().length<2?'0'+(new Date().getMonth()+1):new Date().getMonth()+1
	var ri=new Date().getDate().toString().length<2?'0'+(new Date().getDate().toString()):new Date().getDate().toString()
    $("#datemin").val(year+'-'+Month+'-'+ri)
	var userid='';
    $('.span').click(function(){
        search($("#datemin").val().substr(0,4)+'-'+parseInt($("#datemin").val().substr(5,2))+'-'+parseInt($("#datemin").val().substr(8,2)),$(this).attr('alt'))
    })
    var search=(time,num)=>{
    $(".loadin").show()
    if(year<2018){
        alert('请查询2018年的往后的')
        return false;
    }
    $.ajax({
        type:'post',
        url:network+"/MattrioManager/WelcomeController/getReport",
        data:{
            start_time:time,
            type:num
        },
        success(data){
            $(".loadin").hide()
            $('.tab'+num+ 'tbody').html('')
            switch(parseInt(num)){
                case 3:
                    /*接口调用次数*/
                    $.each(data.list3,function(key,val){
                        var tr=$("<tr>")
                        var td1=$("<td>").html(val.usertype)
                        var td2=$("<td>").html(val.count)
                        td1.appendTo(tr);
                        td2.appendTo(tr);
                        tr.appendTo(".tab3 tbody");
                    })
                    break;
                case 2:
                    /*产品调用次数*/
                    $.each(data.list2,function(key,val){
                        var tr=$("<tr>")
                        var td1=$("<td>").html(val.usertype)
                        var td2=$("<td>").html(val.count)
                        td1.appendTo(tr);
                        td2.appendTo(tr);
                        tr.appendTo(".tab2 tbody");
                    })
                    break;
                case 1:
                    /*客户调用次数*/
                    $.each(data.list1,function(key,val){
                        var tr=$("<tr>")
                        var td1=$("<td>").html(val.user_name)
                        var td2=$("<td>").html(val.phone)
                        var td3=$("<td>").html(val.count)
                        td1.appendTo(tr);
                        td2.appendTo(tr);
                        td3.appendTo(tr);
                        tr.appendTo(".tab1 tbody");
                    })
                    break;
                case 4:
                    /*今日新增客户*/
                    $.each(data.list4,function(key,val){
                        var a=new Date(val.rt_time.time)
                        var tr=$("<tr>")
                        var td1=$("<td>").html(val.other)
                        var td2=$("<td>").html(val.phone)
                        var td3=$("<td>").html(a.toLocaleString())
                        td1.appendTo(tr);
                        td2.appendTo(tr);
                        td3.appendTo(tr);
                        tr.appendTo(".tab4 tbody");
                    })
                    break;
                case 5:
                    /*所有用户*/
                    $.each(data.list5,function(key,val){
                        var tr=$("<tr>")
                        var td1=$("<td>").html(val.usertype)
                        var td2=$("<td>").html(val.count)
                        td1.appendTo(tr);
                        td2.appendTo(tr);
                        tr.appendTo(".tab5 tbody");
                    })
                    break;
                default:
                   alert('错误')
            }
        },error(){
            $(".loadin").hide()
            alert('获取失败请重新获取')
        }
    })
}

	$(document).on("click",".diaoyong tr",function(){
		var id=userid[$(this).index()].user_id
		var name=$(this).children("td:eq(0)").text()
		getProductids(id,name)

	})
	
	function getProductids(id,name) {
			var checkedValues = new Array();
			$('#brands :checkbox').each(function() {
				if($(this).is(':checked')) {
					checkedValues.push($(this).val());
				}
			});
			layer.open({
				type: 2,
				title: name+'  接口调用次数列表',
				maxmin: true,
				shadeClose: true, //点击遮罩关闭层
				area: ['900px', '600px'],
				content:"welcome-list.html?userid="+id,
				cancel: function(index, layero) {
					if(confirm('确定要关闭么')) { //只有当点击confirm框的确定时，该层才会关闭
						layer.close(index);

					}
					return false;
				}
			});
		}
	
	
	
	
	
</script>
</body>
</html>